<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/white/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"default"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":{"disqus":{"text":"Load Disqus","order":-1}},"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false,"trigger":"auto"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前言 VSCode 在一定条件下，无法识别用户环境变量的一种解决方式。">
<meta property="og:type" content="article">
<meta property="og:title" content="解决 VSCode 无法识别用户环境变量的问题">
<meta property="og:url" content="http://example.com/post/20250709131438.html">
<meta property="og:site_name" content="LeeKa 的酒馆">
<meta property="og:description" content="前言 VSCode 在一定条件下，无法识别用户环境变量的一种解决方式。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-09T05:14:38.000Z">
<meta property="article:modified_time" content="2025-07-09T07:45:57.483Z">
<meta property="article:author" content="LeeKa">
<meta property="article:tag" content="VSCode">
<meta property="article:tag" content="环境变量">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/post/20250709131438.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/post/20250709131438.html","path":"post/20250709131438.html","title":"解决 VSCode 无法识别用户环境变量的问题"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>解决 VSCode 无法识别用户环境变量的问题 | LeeKa 的酒馆</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LeeKa 的酒馆</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">欢迎，旅人！坐下来享受一下暖烘烘的炉火吧。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/links/" rel="section"><i class="fa-solid fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text"> 前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="nav-number">2.</span> <span class="nav-text"> 问题描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">3.</span> <span class="nav-text"> 解决方案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E7%82%B9%E5%90%90%E6%A7%BD"><span class="nav-number">4.</span> <span class="nav-text"> 一点吐槽</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-number">5.</span> <span class="nav-text"> 参考文献</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LeeKa"
      src="https://s2.loli.net/2022/03/24/zcq6l9KENbRJtDi.jpg">
  <p class="site-author-name" itemprop="name">LeeKa</p>
  <div class="site-description" itemprop="description">代码、音乐和游戏，一起来聊聊吧</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">182</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/KXAND" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;KXAND" rel="noopener me" target="_blank">GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:leeka.Pub@outlook.com" title="E-Mail → mailto:leeka.Pub@outlook.com" rel="noopener me" target="_blank">E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/QuiXand" title="X → https:&#x2F;&#x2F;twitter.com&#x2F;QuiXand" rel="noopener me" target="_blank">X</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://pinhua.leeka.pub/" title="宁远平话 → https:&#x2F;&#x2F;pinhua.leeka.pub" rel="noopener me" target="_blank">宁远平话</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/post/20250709131438.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://s2.loli.net/2022/03/24/zcq6l9KENbRJtDi.jpg">
      <meta itemprop="name" content="LeeKa">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LeeKa 的酒馆">
      <meta itemprop="description" content="代码、音乐和游戏，一起来聊聊吧">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="解决 VSCode 无法识别用户环境变量的问题 | LeeKa 的酒馆">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          解决 VSCode 无法识别用户环境变量的问题<a href="https://github.com/KXAND/BlogSource/edit/source/_posts/%E6%8A%98%E8%85%BE/%E8%A7%A3%E5%86%B3Vscode%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%97%AE%E9%A2%98.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-07-09 13:14:38 / 修改时间：15:45:57" itemprop="dateCreated datePublished" datetime="2025-07-09T13:14:38+08:00">2025-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%98%E8%85%BE/" itemprop="url" rel="index"><span itemprop="name">折腾</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/post/20250709131438.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="post/20250709131438.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.1k</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2>
<p>VSCode 在一定条件下，无法识别用户环境变量的一种解决方式。 <span id="more"></span></p>
<h2 id="问题描述"><a class="markdownIt-Anchor" href="#问题描述"></a> 问题描述</h2>
<p>不知道从什么时候起，VS Code 突然无法读取用户环境变量了，只能读取到系统环境变量。这事最直观的体现就是，<code>oh-my-posh</code> 无法正常工作了，很烦人。</p>
<p>具体来说，我面临的情况是这样的：</p>
<ul>
<li>我在 Windows 11 上使用 PowerShell 7 和 VS Code</li>
<li>我的用户环境变量的 <code>PATH</code> 和系统环境变量的 <code>PATH</code> 并不保持一致，其中最显著的区别就是 <code>oh-my-posh</code> 的路径是写在用户环境变量中。当然，二者不止这些差别，例如我的 <code>yarn</code> 也是写在用户环境变量中。</li>
<li>当我从 VSCode 终端启动 PowerShell 等 Shell 时时，这些用户环境变量不能被正常读取。这些用户环境变量没有被加载：<code>$env:PATH</code> 中只包含系统环境变量，不包含用户变量，其他自定义变量也都缺失。这种现象最显著的结果是，每次打开终端我只能看到一个红红的报错信息，看不到 <code>oh-my-posh</code> 美化过的结果。当然问题不止于此，实际上 CMD 等其它 Shell 也无法读取用户环境变量。</li>
<li>如果通过 Windows Terminal 启动 Powershell，或者使用管理员模式打开 VS Code。用户环境变量就能正常读取。因此，问题出现在 VSCode 而非 PowerShell 或 <code>oh-my-posh</code>。</li>
</ul>
<p>这个问题无法通过“以后只用管理员模式启动 VS Code”解决，因为 VS Code 管理员模式下只能启动一个实例，这很不方便。<s>尽管有一段时间我就是这么干的</s>。同时，只是简单粗暴地将<code>用户环境变量</code>同步移植到<code>系统环境变量</code>虽然看似能解决问题，但是实际上只是在掩盖问题，因此我们不希望这么干。</p>
<p>这种现象还挺稀有的，我只在 Reddit 上找到了一例相同的情况：<a href="https://www.reddit.com/r/PowerShell/comments/wdhhve/user_env_variables_wont_be_read_when_starting/">User Env Variables wont be read when starting powershell with “pwsh” (version 7.2.5.0) : r/PowerShell</a></p>
<h2 id="解决方案"><a class="markdownIt-Anchor" href="#解决方案"></a> 解决方案</h2>
<p>我目前的解决方案是在 <code>Microsoft.PowerShell_profile.ps1</code> 文件首行中写入如下指令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并系统 PATH 和用户 PATH</span></span><br><span class="line"><span class="variable">$env:Path</span> = [<span class="type">System.Environment</span>]::GetEnvironmentVariable(<span class="string">&quot;Path&quot;</span>, <span class="string">&quot;Machine&quot;</span>) + <span class="string">&quot;;&quot;</span> + [<span class="type">System.Environment</span>]::GetEnvironmentVariable(<span class="string">&quot;Path&quot;</span>, <span class="string">&quot;User&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>这表示在 PowerShell 启动时，将 Path 环境变量自动设置为系统 <code>PATH</code> 变量和用户 <code>PATH</code> 变量的结合。尽管<code>这没有根本解决 VS Code 的问题</code>，但是暂时来说也足够了，因为实际使用中确实很少使用 CMD 等。</p>
<p>我现在的 <code>Microsoft.PowerShell_profile.ps1</code> 文件长这样：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并系统 PATH 和用户 PATH</span></span><br><span class="line"><span class="variable">$env:Path</span> = [<span class="type">System.Environment</span>]::GetEnvironmentVariable(<span class="string">&quot;Path&quot;</span>, <span class="string">&quot;Machine&quot;</span>) + <span class="string">&quot;;&quot;</span> + [<span class="type">System.Environment</span>]::GetEnvironmentVariable(<span class="string">&quot;Path&quot;</span>, <span class="string">&quot;User&quot;</span>)</span><br><span class="line"><span class="built_in">oh</span><span class="literal">-my-posh</span> init pwsh  <span class="literal">--config</span> [我的用户文件地址]\AppData\Local\Programs\oh<span class="literal">-my-posh</span>\themes\multiverse<span class="literal">-neon</span>.omp.json | <span class="built_in">Invoke-Expression</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是拼接环境变量需要在唤醒 <code>oh-my-posh</code> 之前，否则第二行命令中调用的 <code>oh-my-posh</code> 就无法找到了。</p>
<p>上述解决方案由“通义 Qwen3”提供。如果你阅读了我上面提供的 Reddit 链解，你会发现这也是原 Po 使用的解决方案。</p>
<h2 id="一点吐槽"><a class="markdownIt-Anchor" href="#一点吐槽"></a> 一点吐槽</h2>
<p>这个问题我先后询问了三个 AI， Prompt 略有不同。其中唯一有效的解决方案来自通义千问。下面是一个简单的对比：</p>
<ul>
<li>ChatGPT: gpt-4o
<ul>
<li>prompt: <code>I put various paths into the user env like for oh-my-posh. But when pwsh isn't started via Terminal the path of the system and the user env values aren't concatenated. Indeed none of my user env variables are read. This is especially a problem for the invoke via directory context menu.阅读上述文字，搜索网页，给出解决永久的、安全的、方便的解决方案</code>。其中英文部分是上述 Reddit 链接楼主的描述，因为犯懒就没有自己写。</li>
<li>解决方案：
<ul>
<li><code>修改注册表上下文菜单命令以加载新环境</code>：注册表是个大坑，既然我在安装 VSCode 和 oh-my-posh 等时没有动过注册表，那么我应该也不需要动注册表，以免发生预期外的行为。</li>
<li><code>修改环境变量后，重启 Explorer 确保生效</code>：这个是无稽之谈，因为我没有修改环境变量，并且 VS Code 是开机后的第一次启动。</li>
<li><code>确保 PowerShell profile 自动加载 oh-my-posh</code>：这个也是无稽之谈，无论是正常工作的 Terminal 还是 Code 中找不到 oh-my-posh 的报错，都证明 oh-my-posh 被自动加载了，问题出在环境变量的加载上。</li>
</ul>
</li>
</ul>
</li>
<li>DeepSeek R1 深度思考
<ul>
<li>prompt: <code>I put various paths into the user env like for oh-my-posh. But when pwsh isn't started via Terminal the path of the system and the user env values aren't concatenated. Indeed none of my user env variables are read. This is especially a problem for the invoke via directory context menu.阅读上述文字，搜索网页，给出解决永久的、安全的、方便的解决方案</code>。</li>
<li>解决方案：<code>注册表持久化 + 启动脚本修正</code>，和GPT一样，无需多说。</li>
</ul>
</li>
<li>Qwen3 深度思考
<ul>
<li>prompt：<code>I put various paths into the user env like for oh-my-posh. But when pwsh isn't started via Terminal the path of the system and the user env values aren't concatenated. Indeed none of my user env variables are read. This is especially a problem for the invoke via directory context menu.阅读上述文字，搜索网页，给出解决永久的、安全的、方便的解决方案</code>。</li>
<li>解决方案：
<ul>
<li>方法一：<code>修改用户环境变量</code>：不知所谓。</li>
<li>方法二：<code>修改PowerShell配置文件</code>：正确答案，但是没有完全命中，这可能和 Prompt 写得不好有关。</li>
<li>方法三：<code>注册表修改（高级）</code>：Qwen3将修改注册表排在最后并明确注明不推荐，这点我很喜欢。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>可以看到 Qwen 的结果是更好的。不过实际上我在询问 Qwen 时并没有采用这串 Prompt，~~上面 Qwen3 的结果是为了写博客补的，~~而是终于忍受不了，自己写了一个新的 Prompt：</p>
<blockquote>
<p>我在 Windows 上使用 PowerShell 7和VSCode，并通过用户环境变量（如 PATH）添加了一些工具路径（例如 oh-my-posh）。当我从 VSCode 终端启动控制台如 PowerShell 时，这些用户环境变量不能被正常读取。这些用户环境变量没有被加载：$env:PATH 中只包含系统环境变量，不包含用户变量，其他自定义变量也都缺失。</p>
<p>这会导致 oh-my-posh 和其他工具无法使用。</p>
<p>注意，</p>
<ol>
<li>通过管理员模式启动VSCode时，以及通过Windows Terminal启动Shell时，用户环境变量可以被正常加载</li>
<li>非管理员模式启动VSCode时，任何Shell都无法正常加载用户环境变量</li>
</ol>
<p>对此，我需要你通过一个解决方案，安全、高效、永久地解决问题，保证Vscode在非管理员模式下能够合并并正确加载系统和用户环境变量。</p>
<p>请注意</p>
<ol>
<li>ohmyposh不是问题的关键</li>
<li>联网搜索时，使用英文搜索，并且忽略 <a href="http://CSDN.net">CSDN.net</a> 的结果</li>
<li>禁止“每次启动时手动执行初始化脚本”的解决方案，禁止“将用户环境变量迁移系统环境变量”的解决方案</li>
<li>你需要先重复我的要求，确保你完全理解了我的意思</li>
</ol>
</blockquote>
<p>这个串比起从 Reddit 中的信息更准确，突出了问题可能是由 VSCode 引起的。~~我后来才意识到原 Po 并没有提到 VSC。~~Qwen3 的回答如下：</p>
<ol>
<li>显式配置 VSCode 的终端环境变量</li>
<li>修改 PowerShell 配置文件（Profile.ps1）</li>
<li>调整 VSCode 的终端启动参数</li>
</ol>
<p>最终我采用了方案 2（方案 1 即使主要思路对了，给出的细节也表明它直接将用户环境变量和 oh-my-posh 地址划等号了），即上面给出的结果，问题解决了。</p>
<p>最终感悟就是</p>
<ol>
<li>AI 产品还需货比三家，chatGPT 和 DeepSeek R1 都是行业焦点，然而表现效果也并不总是最优，尤其是这种互联网资料较少的情况。</li>
<li>好的 Prompt 对 AI 结果影响也很大。</li>
</ol>
<h2 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> 参考文献</h2>
<ol>
<li><a href="https://www.reddit.com/r/PowerShell/comments/wdhhve/user_env_variables_wont_be_read_when_starting/">User Env Variables wont be read when starting powershell with “pwsh” (version 7.2.5.0) : r/PowerShell</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/VSCode/" rel="tag"><i class="fa fa-tag"></i> VSCode</a>
              <a href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" rel="tag"><i class="fa fa-tag"></i> 环境变量</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/20250613000000.html" rel="prev" title="《BPM：枪林弹雨》（Bullet Per Minute）品鉴报告">
                  <i class="fa fa-angle-left"></i> 《BPM：枪林弹雨》（Bullet Per Minute）品鉴报告
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2020 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">LeeKa</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">145k</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  <script src="/js/third-party/pace.js"></script>


  




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"leekapub","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
